# Home Assistant Deembot aTick BLE Integration

Интеграция для работы с устройством [aTick](https://deembot.com/atick/index.ru.html) от компании Deembot.

> Внимание! Это Альфа версия, в которой реализована только базовая передача показаний от aTick, пока что больше ничего не умеет!
> Подключать само устройство стоит только в базовой конфигурации!
> Разные настройки через приложения могут не поддерживаться и привести к некорректности передаваемых данных.
> В дальнейшем, интеграция должна догнать оф. приложения для Android

Можно одновременно пользоваться, и HA интеграцией, и оригинальным приложением. Заранее требуется указать нужный вам ПИН в приложении для сопряжения устройства

## Установка и Настройка

В первый раз нужно сделать сопряжение aTick с вашим bluetooth, где крутится HA, т.к. HA не умеет делать сопряжение в интерфейсе
Для этого нужно зайти по SSH или в терминал и выполнить поочередно команды

```
bluetoothctl
scan on
pair <mac адресс aTick>
ввести пин когда предложит
scan off
```

После этого добавить интеграциюБ скопировав содержимое `custom_components` в вашу директорию в HA `/usr/share/hassio/homeassistant/custom_components`

Перезагрузить HA, зайти в интеграции и нажать "Добавить интеграцию". В поиске ввести aTick. Следовать шагам настройщика.

> Внимание! Одновременно работа в приложении для телефона и HA невозможно, так что перед началом настройки, выйдите из приложения и отключите bluetooth на телефоне, чтобы устройство точно нашлось
> В списке устройств должен появится ваш aTick который и следует выбрать.

## Доработка

Все желающие, кто может внести улучшения, присылайте PR

Что нужно реализовать:
* Получение/Сохранение настроек устройства в интерфейсе
* Добавить изображение интеграции
* правильно считывать модель устройства и отображать её
* Корректный поиск устройства если оно переименовано
* Корректный расчёт с учётом множителя
* Корректировка показаний (задать начальные показания)
* Настройки энергосбережения (как в приложении)


#### Внешний вид
![1.png](./img/1.png)
